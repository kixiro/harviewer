/* Downloadify 0.1 (c) 2009 by Douglas Neiner. Licensed under the MIT license */

/* See http://github.com/dcneiner/Downloadify for license and more info */

!function(){Downloadify=window.Downloadify={queue:{},uid:(new Date).getTime(),getTextForSave:function(n){return(n=Downloadify.queue[n])?n.getData():""},getFileNameForSave:function(n){return(n=Downloadify.queue[n])?n.getFilename():""},saveComplete:function(n){return(n=Downloadify.queue[n])&&n.complete(),!0},saveCancel:function(n){return(n=Downloadify.queue[n])&&n.cancel(),!0},saveError:function(n){return(n=Downloadify.queue[n])&&n.error(),!0},addToQueue:function(n){Downloadify.queue[n.queue_name]=n},getUID:function(n){return""==n.id&&(n.id="downloadify_"+Downloadify.uid++),n.id}},Downloadify.create=function(n,e){return n="string"==typeof n?document.getElementById(n):n,new Downloadify.Container(n,e)},Downloadify.Container=function(n,e){function o(){a.options=e,a.options.append||(a.el.innerHTML=""),a.flashContainer=document.createElement("span"),a.el.appendChild(a.flashContainer),a.queue_name=Downloadify.getUID(a.flashContainer),"function"==typeof a.options.filename?a.filenameCallback=a.options.filename:a.options.filename&&(a.filename=a.options.filename),"function"==typeof a.options.data?a.dataCallback=a.options.data:a.options.data&&(a.data=a.options.data);var n={queue_name:a.queue_name,width:a.options.width,height:a.options.height},o={allowScriptAccess:"always"},t={id:a.flashContainer.id,name:a.flashContainer.id};a.options.enabled===!1&&(a.enabled=!1),a.options.transparent===!0&&(o.wmode="transparent"),a.options.downloadImage&&(n.downloadImage=a.options.downloadImage),swfobject.embedSWF(a.options.swf,a.flashContainer.id,a.options.width,a.options.height,"10",null,n,o,t),Downloadify.addToQueue(a)}var a=this;a.el=n,a.enabled=!0,a.dataCallback=null,a.filenameCallback=null,a.data=null,a.filename=null,a.enable=function(){var n=document.getElementById(a.flashContainer.id);n.setEnabled(!0),a.enabled=!0},a.disable=function(){var n=document.getElementById(a.flashContainer.id);n.setEnabled(!1),a.enabled=!1},a.getData=function(){return a.enabled?a.dataCallback?a.dataCallback():a.data?a.data:"":""},a.getFilename=function(){return a.filenameCallback?a.filenameCallback():a.filename?a.filename:""},a.complete=function(){"function"==typeof a.options.onComplete&&a.options.onComplete()},a.cancel=function(){"function"==typeof a.options.onCancel&&a.options.onCancel()},a.error=function(){"function"==typeof a.options.onError&&a.options.onError()},o()},Downloadify.defaultOptions={swf:"media/downloadify.swf",downloadImage:"images/download.png",width:100,height:30,transparent:!0,append:!1}}(),"undefined"!=typeof jQuery&&function(n){n.fn.downloadify=function(e){return this.each(function(){e=n.extend({},Downloadify.defaultOptions,e);var o=Downloadify.create(this,e);n(this).data("Downloadify",o)})}}(jQuery);
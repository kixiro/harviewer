/* See license.txt for terms of usage */

define(["./array","core/trace"],function(r,e){var t={};return t.formatSize=function(r){var e=1;if(e=e>2?2:e,e=-1>e?-1:e,-1===e)return r+" B";var t=Math.pow(10,e);return-1===r||void 0===r?"?":0===r?"0":1024>r?r+" B":1048576>r?Math.round(r/1024*t)/t+" KB":Math.round(r/1048576*t)/t+" MB"},t.formatTime=function(r){return-1===r?"-":1e3>r?r+"ms":6e4>r?Math.ceil(r/10)/100+"s":Math.ceil(r/6e4*100)/100+"m"},t.formatNumber=function(r){r=String(r);for(var e=r.split("."),t=e[0],n=e.length>1?"."+e[1]:"",u=/(\d+)(\d{3})/;u.test(t);)t=t.replace(u,"$1 $2");return t+n},t.formatString=function(e){var t=r.cloneArray(arguments);e=t.shift();for(var n=0;n<t.length;n++){var u=t[n].toString();e=e.replace("%S",u)}return e},t.startsWith=function(r,e,t){return t=t||0,r.indexOf(e,t)===t},t.trim=function(r){return r.replace(/^\s*|\s*$/g,"")},t.wrapText=function(r,e){for(var n=/[^A-Za-z_$0-9'"-]/,u=[],a=100,i=t.splitLines(r),s=0;s<i.length;++s){for(var c=i[s];c.length>a;){var p=n.exec(c.substr(a,100)),o=a+(p?p.index:0),f=c.substr(0,o);c=c.substr(o),e||u.push("<pre>"),u.push(e?f:t.escapeHTML(f)),e||u.push("</pre>")}e||u.push("<pre>"),u.push(e?c:t.escapeHTML(c)),e||u.push("</pre>")}return u.join(e?"\n":"")},t.insertWrappedText=function(r,e,n){e.innerHTML="<pre>"+t.wrapText(r,n)+"</pre>"},t.splitLines=function(r){var e=/\r\n|\r|\n/;if(!r)return[];if(r.split)return r.split(e);var t=String(r),n=t.split(e);return n},t.escapeHTML=function(r){function e(r){switch(r){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&#39;";case'"':return"&quot;"}return"?"}return String(r).replace(/[<>&"']/g,e)},t.cropString=function(r,e){r=String(r);var n=e?e/2:50;return r.length>e?t.escapeNewLines(r.substr(0,n)+"..."+r.substr(r.length-n)):t.escapeNewLines(r)},t.escapeNewLines=function(r){return r.replace(/\r/g,"\\r").replace(/\n/g,"\\n")},t});